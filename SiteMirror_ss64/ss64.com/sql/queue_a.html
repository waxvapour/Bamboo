<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/sql/queue_a.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:50:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>ALTER QUEUE - SQL Server - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_sql.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="index.html">SQL</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/sql/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>ALTER QUEUE</h1>
<p>Change the properties of a message queue.</p>
<pre>Syntax
      ALTER QUEUE [<i>database</i>.[<i>schema</i>]. | <i>schema</i>.] <i>queue</i>
      [ WITH
        [ STATUS = {<u>ON</u> | OFF}  [ , ] ]
        [ RETENTION = {ON | <u>OFF</u>} [ , ] ] 
        [ ACTIVATION (
           { [ STATUS = {<u>ON</u> | OFF} , ] 
              PROCEDURE_NAME = [<i>database</i>.[<i>schema</i>]. | <i>schema</i>.] <i>stored_procedure</i> ,
              MAX_QUEUE_READERS = <i>max_readers</i> , 
              EXECUTE AS { SELF | '<i>user_name</i>' | OWNER } 
           | DROP }
               ) ]
      ]
        [ ON { <i>filegroup</i> | [DEFAULT] } ] 
      [;]

Key<i>
   queue</i>     The queue to be altered.
   database  Database containing the queue.
   STATUS    The queue is available (ON) or unavailable (OFF).
   RETENTION Retain all queue Messages using the conversations ends.
             (This can reduce performance)
   STATUS    When STATUS = OFF, the queue does not activate the stored procedure.
   MAX_QUEUE_READERS  Instances of the stored procedure that may run at the same time (0-32767)
   SELF      Run the stored procedure as the user who executes the CREATE QUEUE statement.
   OWNER     Run the stored procedure as the owner of the queue.
   DROP      Delete all activation info associated with the queue.</pre>
<p>  When a queue is unavailable, the Service Broker will hold its messages  in the transmission queue for the database.</p>
<p>Example</p>
<pre>ALTER QUEUE MyQueue<br>    WITH ACTIVATION (<br>        PROCEDURE_NAME = MyDatabase.dbo.my_new_proc ,<br>        EXECUTE AS 'MyDbAccount') ;
</pre>
<p class="quote"><i>&quot;An Englishman, even if he is alone, forms
an orderly queue of one&quot; - George Mikes </i></p>
<p><b>Related commands:</b></p>
<p>  <a href="queue_c.html">CREATE QUEUE</a><br>
  <a href="queue_d.html">DROP QUEUE</a>  <br>
  sys.transmission_queue  <br>
Equivalent Oracle command:  <a href="../orap/DBMS_JOB.html">DBMS_JOB</a></p><!-- #BeginLibraryItem "/Library/foot_sql.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- ss64-sql -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6953563613"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer">&nbsp;</div>
<div id=br class="footer, tagline">Copyright &copy; <a href="../index.html">SS64.com</a> 1999-2018<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/sql/queue_a.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:50:32 GMT -->
</html>
