<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/register-objectevent.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:42:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>Register-ObjectEvent - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="index.html">PowerShell</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>Register-ObjectEvent</h1> 
<p> Subscribe to the events that are generated by a Microsoft .NET Framework object.</p>
<pre>Syntax
      Register-ObjectEvent [-InputObject] <i>psobject</i> [-EventName] <i>string</i>
         [[-SourceIdentifier] <i>string</i>] [[-Action] <i>scriptblock</i>]
            [-Forward] [-MessageData <i>psobject</i>]
               [-SupportEvent] [<i>CommonParameters</i>]

Key:
   -Action <i>scriptblock</i><br>       Commands to handle the events.
       The commands in the Action run when an event is raised, instead of
       sending the event to the event queue.
       Enclose the commands in braces ( { } ) to create a script block. 

       The value of the Action parameter can include the $Event,
       $EventSubscriber, $Sender, $SourceEventArgs, and $SourceArgs automatic variables,
       which provide information about the event to the Action script block.
       For more information, see about_Automatic_Variables.

       Register-ObjectEvent will return an event job object that represents the action.

   -EventName <i>string</i><br>       The event to which you are subscribing.
       Enter the event name. This parameter is required.<br>        <br>       The value of this parameter is not a name that you select for the event subscription.
       It is the name of an event that the .NET Framework object exposes.
       For example, the ManagementEventWatcher class has events named &quot;Event<br>       Arrived&quot; and &quot;Stopped.&quot; To find the event name of an event, use <a href="get-member.html">Get-Member</a>.

   -Forward
       Sends events for this subscription to the session on the local computer.
       Use this parameter when you are registering for events on a remote
       computer or in a remote session.

   -InputObject <i>psobject</i><br>       The .NET Framework object that generates the events.
       Enter a variable that contains the object, or type a command or expression
       that gets the object. This parameter is required.

   -MessageData <i>psobject
</i>       Additional data associated with the event.
       The value of this parameter appears in the MessageData property of the event object.

   -SourceIdentifier <i>string<br></i>       A name that you select for the subscription.
       The name that you select must be unique in the current session.<br>       The default value is the GUID that PowerShell assigns.

       The value of this parameter appears in the SourceIdentifier
       property of the subscriber object and of all event objects associated
       with this subscription.

   -SupportEvent
       Hide the event subscription.
       Use this parameter when the current subscription is part of
       a more complex event registration mechanism and it should not
       be discovered independently.

       To view or cancel a subscription that was created with -SupportEvent,
       use the Force parameter of <a href="get-eventsubscriber.html">Get-EventSubscriber</a> and <a href="unregister-event.html">Unregister-Event</a>.

   <a href="common.html">CommonParameters</a>:
       -Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,
       -OutBuffer -OutVariable.</pre>
<p>
  Register-ObjectEvent  subscribes to events that are generated by .NET Framework objects on the local or remote computer. </p>
<p>When the subscribed event is raised, it is added to the event queue in your session. To get events in the event queue, use Get-Event. Subscribing allows you to forward the events and/or specify an action to respond to the events.</p>
<p>To cancel a subscription, use <a href="unregister-event.html">Unregister-Event</a></p>
<p><b>Examples</b></p>
<p>Subscribe to object events on remote computers, utilising a <a href="syntax-functions.html">function</a>:</p>
<pre># Create sessions
PS C:\&gt; $sess = new-pssession -computername Server01, Server02
    
# run a script for each session which adds subscriptions on the Win32_Process:
PS C:\&gt; invoke-command -session $sess -filepath <b>ProcessCreationEvent.ps1</b>

# get events in the queue
PS C:\&gt; invoke-command -session $sess { get-event }
    
    # ProcessCreationEvent.ps1
    
    function EnableProcessCreationEvent 
    { 
       $query = New-Object System.Management.WqlEventQuery "__InstanceCreationEvent", ` 
           (New-Object TimeSpan 0,0,1), ` 
           "TargetInstance isa 'Win32_Process'" 
       $processWatcher = New-Object System.Management.ManagementEventWatcher $query 
    
       $identifier = "WMI.ProcessCreated" 
       Register-ObjectEvent -input $processWatcher -eventName "EventArrived" `
          -sourceIdentifier $identifier -messageData "Test" -forward 
       } 
    } 
    
    EnableProcessCreationEvent</pre>
<p class="quote"><i>“A beauty is a woman you notice; a charmer is one who notices you” ~ Adlai E. Stevenson</i></p>
<p><b>Related PowerShell Commands:</b></p>
<p>  <a href="register-engineevent.html">Register-EngineEvent</a> - Subscribe to PowerShell events <br> 
Register-WmiEvent - Subscribe to a WMI event<br>
<a href="get-event.html">Get-Event</a> - Get events in the event queue</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer">&nbsp;</div>
<div id=br class="footer, tagline">Copyright &copy; <a href="../index.html">SS64.com</a> 1999-2018<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/register-objectevent.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:42:51 GMT -->
</html>
