<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/ps/syntax-requires.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:51:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>#Requires - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_pssyntax.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="index.html">PowerShell</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>PowerShell #requires</h1>
<p>The <span class="code">#Requires</span> statement prevents a script from running unless the       PowerShell version, modules, snap-ins, and module and snap-in version     prerequisites are met.</p>
<pre>Syntax
      #Requires -Version <i>N</i>[.<i>n</i>]
      #Requires -PSEdition [ Core | Desktop ]
      #Requires –PSSnapin <i>PSSnapin-Name</i> [-Version <i>N</i>[.<i>n</i>]]
      #Requires -Modules { <i>Module-Name</i> | <i>Hashtable</i> } 
      #Requires –ShellId <i>ShellId</i>
      #Requires -RunAsAdministrator

Key
 -Version <i>N</i>[.<i>n</i>]
      Specifies the minimum version of PowerShell that the script requires.
      Enter a major version number and optional minor version number.
      For example: 
        #Requires -Version 3.0

  -PSSnapin <i>PSSnapin-Name</i> [-Version <i>N</i>[.<i>n</i>]]
      Specifies a Windows PowerShell snap-in that the script requires. Enter the snap-in
      name and an optional version number.
      For example: 
        #Requires –PSSnapin DiskSnapin -Version 1.2

  -PSEdition [ Core | Desktop ]
      Ensure that a script runs only on PowerShell Core:  -PSEdition Core
      or ensure that a script runs on PowerShell Desktop: -PSEdition Desktop

  -Modules <i>Module-Name</i> | <i>Hashtable</i>  
      Specifies Windows PowerShell modules that the script requires. Enter the module
      name and an optional version number. The -Modules parameter is introduced in PowerShell 3.0.

      If the required modules are not in the current session, PowerShell imports them.
      If the modules cannot be imported, PowerShell throws a terminating error.

      For each module, type the module name (<i>String</i>) or a hash table
      with the following keys. The value can be a combination of strings
      and hash tables.  

          -- ModuleName. This key is required.
          -- ModuleVersion. This key is required.
          -- GUID. This key is optional.

      For example,
        #Requires -Modules PSWorkflow, @{ModuleName="PSScheduledJob";ModuleVersion=1.0.0.0}  


  -ShellId
      Specifies the shell that the script requires. Enter the shell ID.
          
      For example,
        #Requires –ShellId MyLocalShell


  -RunAsAdministrator
      When this switch parameter is added to your requires statement, it specifies that the
      PowerShell session in which you are running the script must be started with elevated user rights 
      (Run as Administrator).
      For example,
        #Requires -RunAsAdministrator </pre>
<p> A script can include more than one #Requires statement.<br>
The #Requires statements can appear on any line in a script but must be the first item on a line in a script.</p>
<p><b>Example</b></p>
<p>Run the script only in PowerShell 4 or greater:</p>
<p class="code">#Requires –Version 4<br>
# the rest of the script</p>
<p class="quote"><i>&ldquo;A civilization is built on what is required of men, not on that which is provided for them&rdquo; ~ Antoine de Saint-Exupery</i></p>
<p><b>Related PowerShell Commands:</b></p>
<p><a href="syntax-run.html">Run a script</a> - How to run a PowerShell script.<br>
<a href="syntax-automatic-variables.html">Automatic variables</a> -  Variables  created and maintained by  PowerShell $_, $Args, $Error, $Home etc</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer">&nbsp;</div>
<div id=br class="footer, tagline">Copyright &copy; <a href="../index.html">SS64.com</a> 1999-2018<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/ps/syntax-requires.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:51:03 GMT -->
</html>
