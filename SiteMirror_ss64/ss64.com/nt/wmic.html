<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/nt/wmic.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:41:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>WMIC - Windows Management - Windows CMD - SS64.com</title>

<style type="text/css">
.prompt {color: #993300}
</style></head><body><!-- #BeginLibraryItem "/Library/head_nt.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="index.html">CMD</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/nt/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>WMIC.exe</h1> 
<p>Windows Management Instrumentation Command.<br>
Retrieve a huge range of information about local or remote computers. Make configuration changes to multiple remote machines.</p>
<p>The <i>ALIAS</i> defines the component of your system that you want WMIC to interact with.<br>
The WHERE clause can be added to filter down to a specific item, e.g. a specific printer instead of all printers.</p>
<pre>Syntax
    WMIC [<i>global_switch(s)</i>] <i>Alias</i> [<i><a href="#alias_options">options</a></i>] [<a href="#format_specifiers">format</a>]

    WMIC [<i>global_switch(s)</i>] <i>Command</i>

    WMIC [<i>global_switch</i>:<i>value</i>] [<i>global_switch</i>:<i>value</i>] <i>Command</i>

    WMIC CONTEXT

    Interactive mode:
    WMIC

Global_Switches:
 /NODE         Servers to operate against:
                  @filename
                  machine_id &lt;,machine id list&gt;
 /APPEND       Mode for output redirection:  <u>STDOUT</u>, CLIPBOARD, &lt;filename&gt;
 /AUTHLEVEL    Client authentication level:  Default,None,Connect,Call,<u>Pkt</u>,Pktintegrity,Pktprivacy
 /AGGREGATE    Aggregate mode: (column titles)    <u>ON</u>, OFF
 /AUTHORITY    The &lt;authority type&gt; for the connection.
 /FAILFAST     FailFast mode:(timeout for connection to remote machine)   ON, <u>OFF</u>
 /IMPLEVEL     Client impersonation level:    Anonymous,Identify,<u>Impersonate</u>,Delegate
 /INTERACTIVE  Interactive mode:(prompt before WMI schema changes)    ON, <u>OFF</u>
 /LOCALE       Language id.    (ms_409=US)
 /NAMESPACE    Path for the namespace the alias operates against.
 /OUTPUT       Mode for output redirection:    <u>STDOUT</u>, CLIPBOARD, &lt;filename&gt;
 /PASSWORD     Password for session login.   &lt;password&gt;
 /PRIVILEGES   Enable or disable all privileges:  ENABLE, DISABLE
 /RECORD       Log all input commands and output: &lt;FilePath&gt;
 /ROLE         Path for the role containing the alias definitions.
 /TRACE        Output debugging information to stderr.  ON, <u>OFF</u>
 /USER         User for this session:      &lt;domain&gt;\&lt;userid&gt;

 CONTEXT       Display the current state of all global switches.
 CLASS         Escape to full WMI schema.
 PATH          Escape to full WMI object paths.
 QUIT/EXIT     Exit WMIC


Aliases:

 ALIAS               - Access local system aliases [CALL]
 BASEBOARD           - Base board management (motherboard or system board) 
 BIOS                - BIOS management (Basic input/output services) 
 BOOTCONFIG          - Boot configuration
 CDROM               - CD-ROM
 COMPUTERSYSTEM      - Computer system [CALL/SET]
 CPU                 - CPU
 CSPRODUCT           - Computer system product information from SMBIOS. 
 DATAFILE            - DataFiles [CALL]
 DCOMAPP             - DCOM Applications.
 DESKTOP             - User's Desktop
 DESKTOPMONITOR      - Desktop Monitor
 DEVICEMEMORYADDRESS - Device memory addresses
 DISKDRIVE           - Physical disk drive
 DISKQUOTA           - Disk space usage for NTFS volumes.[SET]
 DMACHANNEL          - Direct memory access (DMA) channel
 ENVIRONMENT         - System environment settings [SET]
 FSDIR               - Filesystem directory entry [CALL]
 GROUP               - Group account [CALL]
 IDECONTROLLER       - IDE Controller
 IRQ                 - Interrupt request line
 JOB                 - Jobs scheduled using the schedule service.[CALL]
 LOADORDER           - System services that define execution dependencies. 
 LOGICALDISK         - Local storage devices [CALL/SET]
 LOGON               - LOGON Sessions.
 MEMCACHE            - Cache memory
 MEMORYCHIP          - Memory chip information.
 MEMLOGICAL          - System memory, layout and availability
 MEMPHYSICAL         - Physical memory management
 NETCLIENT           - Network Client management.
 NETLOGIN            - Network login information for a particular user. 
 NETPROTOCOL         - Protocols (and their network characteristics).
 NETUSE              - Active network connection.
 NIC                 - Network Interface Controller (NIC)
 NICCONFIG           - Network adapter. [CALL] 
 NTDOMAIN            - NT Domain. [SET]  
 NTEVENT             - NT Event Log.  
 NTEVENTLOG          - NT eventlog file [CALL/SET]
 ONBOARDDEVICE       - Common adapter devices built into the motherboard.
 OS                  - Operating System/s [CALL/SET]
 PAGEFILE            - Virtual memory file swapping
 PAGEFILESET         - Page file settings [SET]
 PARTITION           - Partitioned areas of a physical disk.
 PORT                - I/O ports
 PORTCONNECTOR       - Physical connection ports
 PRINTER             - Printer device [CALL/SET]
 PRINTERCONFIG       - Printer device configuration  
 PRINTJOB            - Print job [CALL]
 PROCESS             - Processes [CALL]*
 PRODUCT             - Windows Installer [CALL]
 QFE                 - Quick Fix Engineering (patches)
 QUOTASETTING        - Setting information for disk quotas on a volume. [SET]
 RDACCOUNT           - Remote Desktop connection permission [CALL]
 RDNIC               - Remote Desktop connection on a specific network adapter [CALL/SET]
 RDPERMISSIONS       - Permissions to a specific Remote Desktop connection [CALL]
 RDTOGGLE            - Turn Remote Desktop listener on or off remotely[CALL]
 RECOVEROS           - Blue Screen Information [SET]
 REGISTRY            - Computer system registry [SET]
 SCSICONTROLLER      - SCSI Controller [CALL]
 SERVER              - Server information 
 SERVICE             - Service application [CALL]
 SHADOWCOPY          - Shadow copy management [CALL]
 SHADOWSTORAGE       - Shadow copy storage areas [CALL/SET]
 SHARE               - Shared resourcees [CALL]
 SOFTWAREELEMENT     - Elements of a software product*
 SOFTWAREFEATURE     - Subsets of SoftwareElement. [CALL]*
 SOUNDDEV            - Sound Devices 
 STARTUP             - Commands that run automatically when users logon
 SYSACCOUNT          - System account  
 SYSDRIVER           - System driver for a base service. [CALL]
 SYSTEMENCLOSURE     - Physical system enclosure
 SYSTEMSLOT          - Physical connection points including ports,
                       slots and peripherals, and proprietary connections points.
 TAPEDRIVE           - Tape drives  
 TEMPERATURE         - Temperature sensor (electronic thermometer).
 TIMEZONE            - Time zone data 
 UPS                 - Uninterruptible power supply (UPS) 
 USERACCOUNT         - User accounts [CALL/SET]
 VOLTAGE             - Voltage sensor (electronic voltmeter) data
 VOLUME              - Local storage volume [CALL/SET]
 VOLUMEQUOTASETTING  - Associates the disk quota setting with a specific disk volume. [SET]
 VOLUMEUSERQUOTA     - Per user storage volume quotas  [SET]
 WMISET              - WMI service operational parameters [SET]

 for more inofrmation on a specific alias, type alias /?</pre>
<p><span class="code"><b>Options</b></span><b><a id="alias_options"></a></b>  </p>
<blockquote>
<p> By default an alias will return a standard LIST of information, you can also use GET to return one or more specific properties. </p>
<p><span class="code">GET *</span> will also return all properties.</p>
<p>Configuration changes can be made, where indicated above with: [CALL or SET ]</p>
<p>The CREATE and DELETE options allow you to change the WMI schema itself.</p>
</blockquote>
<pre>
   <i>alias</i> 
   <i>alias</i> <u>LIST</u> [BRIEF | <u>FULL</u> | INSTANCE | STATUS |SYSTEM | WRITEABLE]
                [/TRANSLATE:BasicXml<i>|</i>NoComma ]
                   [/EVERY:<i>no_secs</i>] [/FORMAT:<i>format</i>]
   <i>alias</i> GET [<i>property list</i>]
                [/VALUE ] [/<u>ALL</u> ] [/TRANSLATE:BasicXml<i>|</i>NoComma<i> </i>]
                   [/EVERY:<i>no_secs</i>] [/FORMAT:<i>format</i>]
   <i>alias</i> CALL <i>method_name</i> [<i>parameters</i>]
   <i>alias</i> SET [<i>assignments</i>]
   <i>alias</i> CREATE 
   <i>alias</i> DELETE
   <i>alias</i> ASSOC [/RESULTCLASS:<i>classname</i>] [/RESULTROLE:<i>rolename</i>][/ASSOCCLASS:<i>assocclass</i>]

   For more help
   WMIC <i>alias</i> /?
   WMIC <i>alias option</i> /?
   e.g.
   WMIC BIOS CALL /?
   WMIC MEMLOGICAL SET /?</pre>
<blockquote>
<p>The order of the /FORMAT and /TRANSLATE switches is significant: if /TRANSLATE follows /FORMAT, the output is formatted first and then translated. </p>
</blockquote>
<h2>Where</h2>
<blockquote>
<p>The options above can  be filtered with a WHERE clause:</p>
<p><span class="code">Where <i>item</i>='<i>string value</i>' </span># Test if Equal<br>
<span class="code">Where <i>item</i>!='<i>string value</i>' </span>#
NOT EQUAL </p>
<p>Use single quotes to delimit spaces or special characters, do not add spaces to either side of the<span class="code"> = </span>or<span class="code"> != </span><br>
See further examples below.</p>
</blockquote>
<pre><b>Format</b><a id="format_specifiers"></a>:</pre>
<blockquote>
<p>Format defines the layout of the information, XML output is automatically formatted using a default style sheet, while other formats (HTML, Table, MOF, Raw XML etc) can be  specified  using <span class="code"><a href="wmicstylesheets.html">/FORMAT: <i>stylesheet_name</i></a></span></p>
<p>Stylesheets supplied with WMIC: </p>
<pre>    csv.xsl, hform.xsl, htable-sortby.xsl, htable.xsl<br>    texttable.xsl, textvaluelist.xsl, xml.xsl
</pre>
<p>All output files are unicode text (convert to ASCII with <a href="type.html">TYPE</a>)  
Tab Separated Values (.tsv) can be opened in excel </p>
<p>  The PROCESS alias can be used to start a new installation process, if doing this across the network, place the installer files on a share with permissions EVERYONE : Read Only. This is because network credentials will be dropped when jumping from one remote machine to another (unless you have kerberos configured).</p>
</blockquote>
<h2>Notes</h2>
<blockquote>
<p>To run WMIC requires administrator rights and for many operations <a href="syntax-elevate.html">Elevation</a>.</p>
<p>The last element returned by WMIC is  a single <span class="code">&lt;CR&gt;</span> character (an empty line), when running WMIC in a FOR loop you might need to <a href="https://stackoverflow.com/questions/8015489/why-is-the-for-f-loop-in-this-batch-script-evaluating-a-blank-line">remove</a> this, particularly if <a href="delayedexpansion.html">delayed expansion</a> is involved.</p>
<p>The number of WMI properties that can be monitored  has increased with every new version of Windows.</p>
<p>Running WMIC within a batch file it can sometimes hang, possible workarounds for this:<br>
<span class="code">START &quot;&quot; /W CMD /C WMIC <i>options</i>...<br>
WMIC <i>options</i>... &lt;NUL</span></p>
<p> The WMI information  for installed software packages (PACKAGE and SOFTWAREFEATURE) is often incomplete  and inconsistent for a variety of historical reasons. A more reliable method is to retrieve a list of installed programs directly
from the Add/Remove list in the registry, with a VBScript like <a href="installed.txt">this</a> from Torgeir Bakken.</p>
</blockquote>
<p><b>Examples</b></p>
<pre>:: Display the DELL Serial number (also works for some other brands)
WMIC <b>BIOS</b> get serialnumber

:: List the OS build and <a href="ver.html">version</a>
WMIC <b>OS</b> LIST BRIEF

:: List the other available OS <a href="ver.html"></a>information
WMIC <b>OS</b> LIST /?

:: List the computername, locale and Bootdevice
WMIC <b>OS</b> GET csname, locale, bootdevice /value

WMIC <b>OS</b> GET osarchitecture /value

:: Get a list of installed Windows updates on a remote machine, unlike Get-Hotfix, this includes the installation date.
WMIC /NODE:&quot;server64&quot; <b>QFE</b> list 

:: Get the local date and time
WMIC <b>OS</b> GET localdatetime

:: List all local Disks
WMIC <b>LOGICALDISK</b> where drivetype!=4 get deviceid, description, volumename

:: List ipv4 adapters 
WMIC <b>NICCONFIG</b> where (IPEnabled=True and TcpipNetbiosOptions!=null and TcpipNetbiosOptions!=2) GET caption,index,TcpipNetbiosOptions,IPEnabled

:: <a href="https://241931348f64b1d1.wordpress.com/2010/04/21/how-to-disable-netbios-via-command-line-on-windows/">Disable Netbios</a>
WMIC <b>NICCONFIG</b> where (IPEnabled=True and TcpipNetbiosOptions!=null and TcpipNetbiosOptions!=2) CALL SetTcpipNetbios 2

WMIC <b>NTEVENT</b> List Brief

:: List all the running services and save to a file
WMIC <b>SERVICE</b> where (state=&quot;running&quot;) GET caption, name, state &gt; services.tsv

:: Stop the TELNET service (also StartService, PauseService,ResumeService)
WMIC <b>SERVICE</b> where caption='TELNET' CALL StopService

:: Display Printer Status
WMIC <b>PRINTER</b> LIST brief
WMIC <b>PRINTER</b> LIST /?
WMIC <b>PRINTER</b> where PortName=&quot;LPT1:&quot; GET PortName, Name, ShareName
 
WMIC /INTERACTIVE:ON <b>PRINTER</b> where PortName=&quot;LPT1:&quot; DELETE

WMIC <b>PROCESS</b> where name='evil.exe' delete

WMIC /output:&quot;%computername%.txt&quot; <b>MEMORYCHIP</b> where &quot;memorytype=17&quot; get Capacity

WMIC /node:computer64,computer65 <b>PROCESS</b> call create <b>&quot;</b>netstat.exe -ano &gt; C:\output.txt<b>&quot;</b>

WMIC /node:@computers.txt /failfast:on <b>PROCESS</b> call create <b>&quot;</b>\\server\share\installer.cmd<b>&quot;</b>

WMIC /node:computer64 /output:shares.html <b>SHARE</b> get name,path /format:htable

WMIC /node:computer64 <b>SHARE</b> where name=&quot;Share1&quot; 

Interactive mode:
<span class="prompt">C:&gt;</span> WMIC
<span class="prompt"></span><span class="prompt">wmic:root\cli&gt;</span><b> OS</b> get csname
<span class="prompt">wmic:root\cli&gt; </span>quit</pre>
<p><i class="quote">&ldquo;Life is like a game of cards. The hand you are dealt is determinism; the way you play it is free will&rdquo; ~ Jawaharial Nehru</i><br>
<br>
<b>Related:</b><br>
<br>
<a href="systeminfo.html">SYSTEMINFO</a> - List system configuration<br>
<a href="https://isc.sans.edu/diary.html?storyid=2376">The Grammar of WMIC</a> - ISC<br>
<a href="https://www.microsoft.com/en-us/download/details.aspx?id=7684">WMI Diagnosis Utility</a> - Microsoft<br>
<a href="../ps/get-wmiobject.html">Get-WMIobject</a> - Get WMI class information (Powershell)<br>
MOF (Managed Object Format) - A language that describes management information.<br>
<a href="https://msdn.microsoft.com/en-us/library/Aa394572">MSDN full WMI reference</a> - Classes, providers etc</p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- windows300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="7649547908"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer">&nbsp;</div>
<div id=br class="footer, tagline">Copyright &copy; <a href="../index.html">SS64.com</a> 1999-2018<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/nt/wmic.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:41:43 GMT -->
</html>
