<!doctype html><html lang="en">

<!-- Mirrored from ss64.com/nt/shutdown.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:41:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>Shutdown - Shutdown the computer - Windows CMD - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_nt.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../index.html"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="index.html">CMD</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/nt/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>SHUTDOWN.exe</h1> 
<p>Shutdown the computer</p>
<pre>Syntax
      SHUTDOWN [<i>shutdown_option</i>s] [/m \\<i>Computer</i>] [<i>other_options</i>]

shutdown_options:
   /i         Display the GUI (must be the first option)

   /l         Log off. This cannot be used with /m or /d option.

   /s         Shutdown.
   /sg        Shutdown and on the next boot restart any registered applications.

   /r         Shutdown and Restart.
   /g         Shutdown and Restart, after restarting restart any registered applications.

   /a         Abort a system shutdown during the time-out period.

   /p         Turn off the local computer with no time-out or warning
              (only with /d)

   /h         Hibernate the local computer (can be used with /f )

   /e         Document the reason for an unexpected shutdown of a computer.

   /hybrid    Perform a shutdown of the computer and prepare it for fast startup. <b>Windows 10</b>
              Must be used with /s (shutdown) option.

   /f         Force running applications to close.
              This will not prompt for File-Save in any open applications.
              so will result in a loss of any unsaved data.

   /soft      Perform a 'soft' shutdown/restart/logoff. <b>Windows 10</b>
              This will ask programs to close and wait for them to end.

   /fw        Combine with a shutdown option to cause the next boot to go to the
              firmware user interface. <b>Windows 10</b>

   /o         Go to the advanced boot options menu and restart the computer.
              Must be used with /r option. <b>Windows 10</b>

other_options:<br>
   /m \\<i>Computer</i>  A remote computer to shutdown or restart.

   /t <i>xxx</i>      Time until system shutdown in seconds. 
               The valid range for <i>xxx</i> is 0-<b>315360000</b> seconds (10 years) [default=30]
               The /f parameter is implied when a value greater than 0 is specified for /t

   /c "<i>Hello</i>"  An optional shutdown message [Max 127 chars]
               This will appear onscreen before the shutdown, and in the Windows event log comment.

   /d [u][p] :<i>xx</i>:<i>yy</i>
               List the reason code for the shutdown or restart. The following table lists the different values.
                 <b>p</b> will list a <b>P</b>lanned reason code.
                 <b>u</b> will list a <b>U</b>ser Defined reason code.
               If neither p nor u is specified the restart or shutdown is unplann<b>E</b>d.
                  <i>xx</i> = The Major reason code (0-255) see below.
                  <i>yy</i> = The Minor reason code (0-65535)

               For a User defined Reason the Major reason code must be in the range 64-255,
                (If not it will be ignored and logged as unplann<b>E</b>d.)</pre>
<h2> Alert Messages to logged in users
</h2>
<blockquote>
<p>Shutdown will display one or two alert messages to the user depending on the delay (set with <span class="code">/t</span>) as follows:</p>
<p><span class="code">Delay<br>
&lt; 3 minutes</span> - A custom popup alert appears immediately (default).<br>
<span class="code">&gt;=3 mins and &lt;=10 mins</span> - 
A custom popup alert  immediately and then a generic popup alert<b> 2 mins</b> before shutdown.<br>
<span class="code">&gt; 10 mins and &lt; 11 mins</span> -  A  system tray alert (with custom message) appears immediately, and then nothing else.<br>
<span class="code">&gt;=11 mins </span>- A  system tray alert (with custom message) appears immediately, and then a generic popup alert <b>10 mins</b> before shutdown.</p>
<p> System Tray alerts can be disabled/hidden by the user.<br>
Also, if the computer goes to sleep (due to Power management) before the shutdown actually occurs, then the countdown will resume after the machine is re-awakened - so the delay is running time not clock time. <br>
For these reasons, setting a delay longer than 10 minutes (600 seconds) is not recommended.</p>
<p>If the computer is manually restarted before the schedule set with Shutdown.exe, the scheduled shutdown will be  aborted.</p>
<p>If two shutdown commands are issued against the same computer,  the first command will run and the second will fail with errorlevel 1190. If you need to make a change, abort the first command with <span class="code">shutdown /a</span></p>
</blockquote>
<h2>Restarting Registered Applications</h2>
<blockquote>
<p>The Windows Restart Manager, introduced in Windows Vista, supports  restarting applications after a system shutdown if they have been registered for restart with the <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-registerapplicationrestart">RegisterApplicationRestart</a> API. <br>
If the application is forcefully shutdown, (not a
standard gracefull termination) then the Restart Manager will not attempt to restart the application.</p>
<p>This functionality is used by Windows Update, Microsoft Office, IE/Edge, Visual Studio, and many other recent applications</p>
</blockquote>
<h2>Event Log</h2>
<blockquote>
<p>Just before the computer is shutdown, shutdown.exe will record the shutdown event in the Windows SYSTEM Event log with a Source=User32 and  event ID 1074  along with any custom message &amp; reason code.</p>
<p>The event log is the only way to tell that a reboot triggered from Shutdown.exe is pending. It also records the username and date/time when the shutdown command was issued.</p>
<p>When using Shutdown.exe to reboot a server, the shutdown process will normally allow  30 seconds to ensure each running service has time to stop. Services are shutdown in alphabetical order. Halting the services manually in  a specific order with <a href="net-service.html">NET STOP</a> or <a href="sc.html">SC</a> can be slightly faster.</p>
</blockquote>
<h2>   Reason codes</h2>
<p>  <span class="code"> &nbsp;E</span> = unplann<b>E</b>d  <span class="code">0x10000000</span><br>
  <span class="code">&nbsp; U</span> = Unexpected <span class="code">0x00000000</span><br>
<span class="code">&nbsp;&nbsp;&nbsp;P</span> = Planned<span class="code"> 0x80000000</span><br>
<span class="code">&nbsp;&nbsp;&nbsp;C</span> = customer defined <span class="code">0x40000000</span> (for these, specify your own Major reason # in the range 64-255)</p>
<pre>
Type    Major Minor Title
  U      0     0    Other (Unplanned)
 E       0     0    Other (Unplanned) 
 E P     0     0    Other (Planned)
  U      0     5    Other Failure: System Unresponsive
 E       1     1    Hardware: Maintenance (Unplanned)
 E P     1     1    Hardware: Maintenance (Planned)
 E       1     2    Hardware: Installation (Unplanned)
 E P     1     2    Hardware: Installation (Planned)
   P     2     3    Operating System: Upgrade (Planned)
 E       2     4    Operating System: Reconfiguration (Unplanned)
 E P     2     4    Operating System: Reconfiguration (Planned)
   P     2     16   Operating System: Service pack (Planned)
         2     17   Operating System: Hot fix (Unplanned)
   P     2     17   Operating System: Hot fix (Planned)
         2     18   Operating System: Security fix (Unplanned)
   P     2     18   Operating System: Security fix (Planned)
 E       4     1    Application: Maintenance (Unplanned)
 E P     4     1    Application: Maintenance (Planned)
 E P     4     2    Application: Installation (Planned)
 E       4     5    Application: Unresponsive
 E       4     6    Application: Unstable
  U      5     15   System Failure: Stop error
 E       5     19   Security issue
  U      5     19   Security issue
 E P     5     19   Security issue
 E       5     20   Loss of network connectivity (Unplanned)
  U      6     11   Power Failure: Cord Unplugged
  U      6     12   Power Failure: Environment
   P     7     0    Legacy API shutdown</pre>
<p>The reason codes, specified with <span class="code">/d</span> are logged in the Windows <b>System</b> Event Log as <a href="https://msdn.microsoft.com/en-us/library/aa376885.aspx">System Shutdown Reason Codes</a> (in Hex).<br>
</p>
<p>Shutdown.exe will also accept options prefixed with dashes instead of forward slashes: <span class="code">-s -f</span> etc</p>
<p><b>Examples</b></p>
<p> Shutdown the local system in one second from now:<br>
<br>
<span class="code">SHUTDOWN.exe /s /f /t 1</span><br>
<br>
Restart the  remote system <span class="code">server64</span> in 60 seconds time and specify the reason &quot;Application: Installation (Planned)&quot; <span class="code">[0x80040002</span>]: </p>
<p class="code"> SHUTDOWN.exe /r /f /m \\Server64 /t 60  /d P:4:2</p>
<p>To shut down the local machine in 30 seconds time, force running applications to close, restart the computer after shutdown, indicate a user code, indicate that the shutdown is planned, log major/minor reason codes and a comment:   </p>
<p class="code">shutdown /r /f   /c &quot;Demo of Shutdown&quot; /d up:125:1</p>
<p>Restart the  remote system <span class="code">server64</span> and specify the reason &quot;Security Fix, Planned&quot; </p>
<p class="code">shutdown /r /f /m \\server64 /d P:2:17</p>
<p>Using PowerShell, remotely restart a list of computers from a text file of computer names.</p>
<pre>
$msg = &quot;Due to network maintenance, this computer must be restarted. You have 5 minutes to save your work&quot;
$delay = 300  # seconds
$computers = <a href="../ps/get-content.html">get-content</a> E:\work\MachineNames.txt
foreach ($computer in $computers)
{
   &amp; 'C:\Windows\System32\<span class="code">SHUTDOWN.exe</span>' &quot;-m \\$computer <b>-r</b> -c $msg -t $delay&quot;
}</pre>
<p class="quote"><i> &ldquo;I shall go the way of the open sea, To the lands I knew before you came,<br>
And the cool ocean breezes shall blow from me, The memory of your name&rdquo; ~ Laurence Hope</i></p>
<p>  <b> Related:</b><br>
  <br>
  <a href="logoff.html">LOGOFF</a> - Log off a user.<br>
<a href="psshutdown.html">PsShutdown</a> - Shutdown/reboot/logoff one or multiple computers.<br>
<a href="schtasks.html">SCHTASKS</a> - Schedule a command to run at a specific time.<br>
<a href="eventcreate.html">EVENTCREATE</a> - Add a message to the Windows event log<br>
PowerShell: <a href="../ps/stop-computer.html">Stop-Computer</a> / <a href="../ps/restart-computer.html">Restart-Computer</a></p><!-- #BeginLibraryItem "/Library/foot_nt.lbi" --><p><script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
<!-- windows300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="7649547908"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer">&nbsp;</div>
<div id=br class="footer, tagline">Copyright &copy; <a href="../index.html">SS64.com</a> 1999-2018<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>

<!-- Mirrored from ss64.com/nt/shutdown.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 22 Nov 2018 11:41:38 GMT -->
</html>
